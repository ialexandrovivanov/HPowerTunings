@using HPowerTunings.ViewModels.RepairModels
@model List<AdminRepairViewModel>
@{ Layout = "_LayoutBoss";}
<style>
    body {
        background-color: rgb(240, 240, 230)
    }
</style>
<body>
    @if (Model.FirstOrDefault() != null)
    {

        <h2 class="mt-4 pt-5 conteiner-fluid justify-content-center text-center">Finilized repairs for Period</h2>
        <hr style="width: 25%;" />
        <div class="conteiner-fluid justify-content-center text-center" style="width:400px;">
            @foreach (var item in Model.OrderByDescending(m => m.FinishedOn))
            {
                <div style="border:1px solid #000; border-radius:6px; padding-bottom:15px">
                    <div class="conteiner-fluid justify-content-center mb-2"
                         style="background-color:honeydew; border-radius:6px; padding-top:5px; padding-top:15px; padding-bottom:10px">
                        <h4>
                            Repair on car with Reg. numer: <strong>@item.Car.RegNumber</strong>
                        </h4>
                        <p><h4><strong>@item.Car.CarBrand - @item.Car.CarModel</strong></h4></p>
                    </div>
                    <div class="container-fluid text-center">
                        @{ bool check = @item.IsRepairPending != null ? @item.IsRepairPending.Value : false; }
                        @if (check)
                        {
                            <h5 style="background-color:darksalmon; border-radius:6px; display: inline-block">
                                <strong>Repair Is Pending</strong>
                            </h5>
                        }
                        @if (@item.Car != null)
                        {
                            <div class="conteiner-fluid justify-content-center text-center">
                                <p>Repair name: <strong>@item.RepairName</strong></p>
                                <p>Repair description: <strong>@item.Description</strong></p>
                                <p>Car brand: <strong>@item.Car.CarBrand</strong> / Car model: <strong>@item.Car.CarModel</strong></p>
                                <p>Car registrational number: <strong>@item.Car.RegNumber</strong></p>
                                <p>Car VIN number: <strong>@item.Car.Rama</strong></p>
                            </div>

                        }
                        <p>Repair started on: <strong>@item.CreatedOn</strong></p>
                        <p>Repair finished on:  <strong>@item.FinishedOn</strong></p>
                        <p>Repair price was: <strong>@item.RepairPrice</strong></p>
                    </div>
                    <div class="text-center" style="background-color:beige; display: inline-block; border-radius:6px; width:398px">
                        <h5>
                            <strong>Mechanics operated in this repair:</strong>
                        </h5>
                    </div>
                    <div class="text-center">
                        @foreach (var empl in @item.Employees)
                        {
                            <h5 class="mt-2 mb-2 text-center">
                                @empl.FullName
                            </h5>
                        }
                    </div>
                    <div class="text-center">
                        <h5 class="mt-2 mb-2 text-center" style="background-color:beige; display: inline-block; border-radius:6px; width:398px">
                            <strong>Parts used in this repair:</strong>
                        </h5>
                    </div>
                    @foreach (var part in @item.Parts)
                    {
                        <p class="mt-2 mb-2 text-center">
                            Part name: <strong>@part.Name</strong> / Part price: <strong>@part.Price</strong>
                        </p>
                    }
                </div>
                <br />
            }
            <div class="text-center">
                <div class="d-inline-block text-center" style="background-color:darksalmon; border-radius:6px; width:400px; padding-top:5px">
                    <h5>Incomes for period: <strong>$@Model.FirstOrDefault()?.TotalIncomes</strong></h5>
                    <h5>Outgoings for period: <strong>$@Model.Sum(r => r.TotalOutgoings)</strong></h5>
                    @{
                        var incomes = Model.FirstOrDefault()?.TotalIncomes;
                        var outgoings = Model.Sum(r => r.TotalOutgoings);
                        var result = incomes - outgoings;
                        <h5><strong>Total</strong> for period: <strong>$@result</strong></h5>
                    }
                </div>
            </div>
            <div class="pt-5 mt-5"></div>
        </div>

    }
    else
    {
        <div class="text-center pt-5 mt-5"><h4>No repairs for this period</h4></div>
        <p></p>
        <a href="/repair/index"><h5>Return</h5></a>
    }
</body>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
